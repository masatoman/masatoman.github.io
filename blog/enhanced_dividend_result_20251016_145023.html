
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŠ•è³‡åˆ¤æ–­ç‰¹åŒ–å‹é«˜é…å½“æ ªã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°çµæœ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #1e293b;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 8px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.1rem;
            color: #64748b;
            margin-bottom: 5px;
        }
        
        .main-table {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 8px;
            padding: 0;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .table-header {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            padding: 20px 30px;
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .table-container {
            overflow-x: auto;
        }
        
        .table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }
        
        .table thead th {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            color: #475569;
            padding: 16px 12px;
            text-align: center;
            font-weight: 600;
            border-bottom: 2px solid #cbd5e1;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .table tbody tr {
            transition: all 0.3s ease;
            border-bottom: 1px solid #f1f5f9;
        }
        
        .table tbody tr:nth-child(even) {
            background: #fafbfc;
        }
        
        .table tbody tr:hover {
            background: linear-gradient(135deg, #dbeafe 0%, #e0e7ff 100%);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        
        .table td {
            padding: 14px 12px;
            text-align: center;
            vertical-align: middle;
            border: none;
        }
        
        .text-success {
            color: #059669 !important;
            font-weight: 600;
        }
        
        .text-warning {
            color: #d97706 !important;
            font-weight: 600;
        }
        
        .text-danger {
            color: #dc2626 !important;
            font-weight: 600;
        }
        
        .controls {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .control-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            cursor: pointer;
            padding: 10px;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 6px;
            transition: all 0.3s ease;
        }
        
        .control-header:hover {
            background: linear-gradient(135deg, #e2e8f0 0%, #cbd5e1 100%);
        }
        
        .control-header h3 {
            color: #1e293b;
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .control-content {
            display: none;
        }
        
        .control-content.active {
            display: block;
        }
        
        .btn-filter {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            margin: 5px;
            transition: all 0.3s ease;
        }
        
        .btn-filter:hover {
            background: linear-gradient(135deg, #1d4ed8 0%, #1e40af 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }
        
        .btn-filter.active {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
        }
        
        .column-filter {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        
        .column-filter label {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            background: #f8fafc;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }
        
        .column-filter label:hover {
            background: #e2e8f0;
        }
        
        .column-filter input[type="checkbox"] {
            margin-right: 8px;
        }
        
        .explanation-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .explanation-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            cursor: pointer;
            padding: 10px;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 6px;
            transition: all 0.3s ease;
        }
        
        .explanation-header:hover {
            background: linear-gradient(135deg, #e2e8f0 0%, #cbd5e1 100%);
        }
        
        .explanation-header h3 {
            color: #1e293b;
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .explanation-content {
            display: none;
        }
        
        .explanation-content.active {
            display: block;
        }
        
        .explanation-card {
            background: #f8fafc;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #3b82f6;
        }
        
        .explanation-card h6 {
            color: #1e293b;
            margin-bottom: 15px;
            font-size: 1rem;
            font-weight: 600;
        }
        
        .explanation-card p {
            color: #64748b;
            line-height: 1.6;
            margin-bottom: 10px;
        }
        
        .portfolio-form {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .portfolio-form h3 {
            color: #1e293b;
            margin-bottom: 20px;
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .portfolio-header {
            color: #1e293b;
            margin-bottom: 20px;
            font-size: 1.2rem;
            font-weight: 600;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border-radius: 6px;
            padding: 15px;
            border-left: 4px solid #3b82f6;
            transition: all 0.3s ease;
        }
        
        .portfolio-header:hover {
            background: linear-gradient(135deg, #e0f2fe 0%, #bae6fd 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.2);
        }
        
        .form-group {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            gap: 15px;
        }
        
        .form-group label {
            color: #374151;
            font-weight: 500;
            min-width: 120px;
        }
        
        .form-group input, .form-group select {
            padding: 8px 12px;
            border: 2px solid #e5e7eb;
            border-radius: 6px;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }
        
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .btn-calculate {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-calculate:hover {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
        }
        
        .portfolio-summary {
            background: linear-gradient(135deg, #dbeafe 0%, #e0e7ff 100%);
            border-radius: 6px;
            padding: 15px;
            margin-top: 15px;
            display: none;
        }
        
        .portfolio-summary.active {
            display: block;
        }
        
        .portfolio-summary h4 {
            color: #1e293b;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        
        .portfolio-summary p {
            color: #64748b;
            margin-bottom: 5px;
        }
        
        .industry-distribution {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border-radius: 6px;
            padding: 15px;
            margin-top: 15px;
            display: none;
        }
        
        .industry-distribution.active {
            display: block;
        }
        
        .industry-distribution h4 {
            color: #1e293b;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }
        
        .industry-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            margin-bottom: 8px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 4px;
            border-left: 4px solid #3b82f6;
        }
        
        .industry-item:last-child {
            margin-bottom: 0;
        }
        
        .industry-name {
            color: #374151;
            font-weight: 500;
        }
        
        .industry-stats {
            color: #64748b;
            font-size: 0.9rem;
        }
        
        .industry-bar {
            width: 100%;
            height: 6px;
            background: #e5e7eb;
            border-radius: 3px;
            margin-top: 5px;
            overflow: hidden;
        }
        
        .industry-bar-fill {
            height: 100%;
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            border-radius: 3px;
            transition: width 0.3s ease;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .table {
                font-size: 0.8rem;
                min-width: 1200px;
            }
            
            .table th, .table td {
                padding: 10px 6px;
            }
            
            .form-group {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .form-group label {
                min-width: auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ’° æŠ•è³‡åˆ¤æ–­ç‰¹åŒ–å‹é«˜é…å½“æ ªã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°çµæœ</h1>
            <p>ç”Ÿæˆæ—¥æ™‚: 2025å¹´10æœˆ16æ—¥ 14:50:23</p>
            <p>ç·éŠ˜æŸ„æ•°: 16éŠ˜æŸ„</p>
        </div>
        
        
        <div class="portfolio-form">
            <h3 class="portfolio-header" onclick="togglePortfolio()" style="cursor: pointer;">
                ğŸ’° åˆ†æ•£æŠ•è³‡è¨ˆç®—ãƒ„ãƒ¼ãƒ« <span id="portfolioIcon">â–¼</span>
            </h3>
            <div class="portfolio-content" id="portfolioContent" style="display: none;">
                <div class="form-group">
                    <label for="totalAmount">æŠ•è³‡ç·é¡ï¼ˆå††ï¼‰:</label>
                    <input type="number" id="totalAmount" value="100000" min="10000" step="10000">
                </div>
                <div class="form-group">
                    <label for="numStocks">æŠ•è³‡éŠ˜æŸ„æ•°:</label>
                    <input type="number" id="numStocks" value="10" min="1" max="20">
                </div>
                <div class="form-group">
                    <label for="minScore">æœ€ä½æŠ•è³‡ã‚¹ã‚³ã‚¢:</label>
                    <input type="number" id="minScore" value="70" min="0" max="100">
                </div>
                <div class="form-group">
                    <label for="strategy">é…åˆ†æˆ¦ç•¥:</label>
                    <select id="strategy">
                        <option value="equal">ç­‰é…åˆ†</option>
                        <option value="score_weighted" selected>æŠ•è³‡ã‚¹ã‚³ã‚¢åŠ é‡</option>
                        <option value="dividend_weighted">é…å½“åˆ©å›ã‚ŠåŠ é‡</option>
                    </select>
                </div>
                <button id="calculateBtn" class="btn-calculate" onclick="calculatePortfolio()">ğŸ“Š åˆ†æ•£æŠ•è³‡ã‚’è¨ˆç®—</button>
                <div class="portfolio-summary" id="portfolioSummary"></div>
            </div>
        </div>
        
        
        <div class="main-table">
            <div class="table-header">
                ğŸ“ˆ é«˜é…å½“æ ªã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°çµæœ
            </div>
            <div class="table-container">
                <table class="table" id="mainTable">
                    <thead>
                        <tr>
                            <th>é †ä½</th>
                            <th>éŠ˜æŸ„ã‚³ãƒ¼ãƒ‰</th>
                            <th>éŠ˜æŸ„å</th>
                            <th>ç¾åœ¨å€¤</th>
                            <th>é…å½“åˆ©å›ã‚Š</th>
                            <th>é…å½“æ€§å‘</th>
                            <th>1æ ªé…å½“</th>
                            <th>é…å½“ã‚«ãƒãƒ¬ãƒƒã‚¸</th>
                            <th>EPS</th>
                            <th>PER</th>
                            <th>PBR</th>
                            <th>PSR</th>
                            <th>ROE</th>
                            <th>å–¶æ¥­åˆ©ç›Šç‡</th>
                            <th>æ™‚ä¾¡ç·é¡</th>
                            <th>æ¥­ç•Œ</th>
                            <th>æŠ•è³‡ã‚¹ã‚³ã‚¢</th>
                            <th>æŠ•è³‡æ¨å¥¨</th>
                            <th class="portfolio-column" style="display: none;">è³¼å…¥æ ªæ•°</th>
                            <th class="portfolio-column" style="display: none;">æŠ•è³‡é‡‘é¡</th>
                            <th class="portfolio-column" style="display: none;">å¹´é–“é…å½“åå…¥</th>
                        </tr>
                    </thead>
                    <tbody>
                        
            <tr>
                <td>1</td>
                <td>3176</td>
                <td>ä¸‰æ´‹è²¿æ˜“</td>
                <td>1568å††</td>
                <td>3.64%</td>
                <td>32.0%</td>
                <td>58å††</td>
                <td>3.1</td>
                <td>181å††</td>
                <td>8.7å€</td>
                <td>0.9å€</td>
                <td>0.3å€</td>
                <td>11.4%</td>
                <td>0.0%</td>
                <td>45å„„å††</td>
                <td>Industrial Distribution</td>
                <td>80ç‚¹</td>
                <td class="text-success">ğŸŸ¢ å¼·åŠ›æ¨å¥¨</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
            </tr>
            
            <tr>
                <td>2</td>
                <td>5121</td>
                <td>è—¤å€‰ã‚³ãƒ³ãƒã‚¸ãƒƒãƒˆ</td>
                <td>1929å††</td>
                <td>3.68%</td>
                <td>32.3%</td>
                <td>66å††</td>
                <td>3.0</td>
                <td>198å††</td>
                <td>9.7å€</td>
                <td>1.1å€</td>
                <td>0.9å€</td>
                <td>11.3%</td>
                <td>0.0%</td>
                <td>37å„„å††</td>
                <td>Auto Parts</td>
                <td>77ç‚¹</td>
                <td class="text-success">ğŸŸ¡ æ¨å¥¨</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
            </tr>
            
            <tr>
                <td>3</td>
                <td>7134</td>
                <td>ã‚¢ãƒƒãƒ—ã‚¬ãƒ¬ãƒ¼ã‚¸ã‚°ãƒ«ãƒ¼ãƒ—</td>
                <td>1120å††</td>
                <td>3.26%</td>
                <td>30.5%</td>
                <td>36å††</td>
                <td>2.7</td>
                <td>99å††</td>
                <td>11.3å€</td>
                <td>1.9å€</td>
                <td>0.6å€</td>
                <td>18.2%</td>
                <td>0.0%</td>
                <td>9å„„å††</td>
                <td>Auto & Truck Dealerships</td>
                <td>75ç‚¹</td>
                <td class="text-success">ğŸŸ¡ æ¨å¥¨</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
            </tr>
            
            <tr>
                <td>4</td>
                <td>6859</td>
                <td>ã‚¨ã‚¹ãƒšãƒƒã‚¯</td>
                <td>3370å††</td>
                <td>3.41%</td>
                <td>34.5%</td>
                <td>115å††</td>
                <td>2.4</td>
                <td>275å††</td>
                <td>12.3å€</td>
                <td>1.3å€</td>
                <td>1.1å€</td>
                <td>11.0%</td>
                <td>0.0%</td>
                <td>75å„„å††</td>
                <td>Scientific & Technical Instruments</td>
                <td>74ç‚¹</td>
                <td class="text-success">ğŸŸ¡ æ¨å¥¨</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
            </tr>
            
            <tr>
                <td>5</td>
                <td>1835</td>
                <td>æ±é‰„å·¥æ¥­</td>
                <td>4245å††</td>
                <td>3.31%</td>
                <td>40.2%</td>
                <td>140å††</td>
                <td>2.4</td>
                <td>336å††</td>
                <td>12.6å€</td>
                <td>1.2å€</td>
                <td>0.9å€</td>
                <td>10.1%</td>
                <td>0.0%</td>
                <td>146å„„å††</td>
                <td>Engineering & Construction</td>
                <td>74ç‚¹</td>
                <td class="text-success">ğŸŸ¡ æ¨å¥¨</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
            </tr>
            
            <tr>
                <td>6</td>
                <td>6458</td>
                <td>æ–°æ™ƒå·¥æ¥­</td>
                <td>1280å††</td>
                <td>3.91%</td>
                <td>46.4%</td>
                <td>60å††</td>
                <td>1.8</td>
                <td>108å††</td>
                <td>11.9å€</td>
                <td>1.5å€</td>
                <td>1.6å€</td>
                <td>12.8%</td>
                <td>0.0%</td>
                <td>89å„„å††</td>
                <td>Building Products & Equipment</td>
                <td>72ç‚¹</td>
                <td class="text-success">ğŸŸ¡ æ¨å¥¨</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
            </tr>
            
            <tr>
                <td>7</td>
                <td>3150</td>
                <td>ã‚°ãƒªãƒ ã‚¹</td>
                <td>2339å††</td>
                <td>3.72%</td>
                <td>40.1%</td>
                <td>85å††</td>
                <td>2.3</td>
                <td>197å††</td>
                <td>11.9å€</td>
                <td>3.3å€</td>
                <td>1.6å€</td>
                <td>31.3%</td>
                <td>0.0%</td>
                <td>53å„„å††</td>
                <td>Utilities - Regulated Electric</td>
                <td>72ç‚¹</td>
                <td class="text-success">ğŸŸ¡ æ¨å¥¨</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
            </tr>
            
            <tr>
                <td>8</td>
                <td>4848</td>
                <td>ãƒ•ãƒ«ã‚­ãƒ£ã‚¹ãƒˆï¼¨ï¼¬ï¼¤ï¼§</td>
                <td>1710å††</td>
                <td>3.68%</td>
                <td>45.5%</td>
                <td>63å††</td>
                <td>2.5</td>
                <td>156å††</td>
                <td>11.0å€</td>
                <td>2.1å€</td>
                <td>0.9å€</td>
                <td>20.3%</td>
                <td>0.0%</td>
                <td>60å„„å††</td>
                <td>Staffing & Employment Services</td>
                <td>72ç‚¹</td>
                <td class="text-success">ğŸŸ¡ æ¨å¥¨</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
            </tr>
            
            <tr>
                <td>9</td>
                <td>9743</td>
                <td>ä¸¹é’ç¤¾</td>
                <td>1356å††</td>
                <td>5.16%</td>
                <td>49.2%</td>
                <td>70å††</td>
                <td>1.2</td>
                <td>82å††</td>
                <td>16.5å€</td>
                <td>1.9å€</td>
                <td>0.6å€</td>
                <td>11.9%</td>
                <td>0.0%</td>
                <td>64å„„å††</td>
                <td>Specialty Business Services</td>
                <td>71ç‚¹</td>
                <td class="text-success">ğŸŸ¡ æ¨å¥¨</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
            </tr>
            
            <tr>
                <td>10</td>
                <td>9715</td>
                <td>ãƒˆãƒ©ãƒ³ã‚¹ãƒ»ã‚³ã‚¹ãƒ¢ã‚¹</td>
                <td>3550å††</td>
                <td>3.11%</td>
                <td>37.4%</td>
                <td>108å††</td>
                <td>2.8</td>
                <td>302å††</td>
                <td>11.7å€</td>
                <td>1.1å€</td>
                <td>0.4å€</td>
                <td>10.0%</td>
                <td>0.0%</td>
                <td>133å„„å††</td>
                <td>Information Technology Services</td>
                <td>69ç‚¹</td>
                <td class="text-success">ğŸŸ¡ æ¨å¥¨</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
            </tr>
            
            <tr>
                <td>11</td>
                <td>1926</td>
                <td>ãƒ©ã‚¤ãƒˆå·¥æ¥­</td>
                <td>3260å††</td>
                <td>3.44%</td>
                <td>46.7%</td>
                <td>107å††</td>
                <td>2.0</td>
                <td>214å††</td>
                <td>15.2å€</td>
                <td>1.6å€</td>
                <td>1.1å€</td>
                <td>11.1%</td>
                <td>0.0%</td>
                <td>139å„„å††</td>
                <td>Engineering & Construction</td>
                <td>66ç‚¹</td>
                <td class="text-success">ğŸŸ¡ æ¨å¥¨</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
            </tr>
            
            <tr>
                <td>12</td>
                <td>4220</td>
                <td>ãƒªã‚±ãƒ³ãƒ†ã‚¯ãƒã‚¹</td>
                <td>1232å††</td>
                <td>3.33%</td>
                <td>29.8%</td>
                <td>41å††</td>
                <td>3.4</td>
                <td>138å††</td>
                <td>8.9å€</td>
                <td>1.0å€</td>
                <td>0.5å€</td>
                <td>11.4%</td>
                <td>0.0%</td>
                <td>61å„„å††</td>
                <td>Chemicals</td>
                <td>65ç‚¹</td>
                <td class="text-success">ğŸŸ¡ æ¨å¥¨</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
            </tr>
            
            <tr>
                <td>13</td>
                <td>9416</td>
                <td>ãƒ“ã‚¸ãƒ§ãƒ³</td>
                <td>1232å††</td>
                <td>3.65%</td>
                <td>47.1%</td>
                <td>50å††</td>
                <td>1.4</td>
                <td>70å††</td>
                <td>17.7å€</td>
                <td>3.4å€</td>
                <td>1.6å€</td>
                <td>21.2%</td>
                <td>0.0%</td>
                <td>61å„„å††</td>
                <td>Telecom Services</td>
                <td>63ç‚¹</td>
                <td class="text-success">ğŸŸ¡ æ¨å¥¨</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
            </tr>
            
            <tr>
                <td>14</td>
                <td>3433</td>
                <td>ãƒˆãƒ¼ã‚«ãƒ­</td>
                <td>2146å††</td>
                <td>3.59%</td>
                <td>50.2%</td>
                <td>72å††</td>
                <td>1.9</td>
                <td>135å††</td>
                <td>15.8å€</td>
                <td>2.1å€</td>
                <td>2.3å€</td>
                <td>13.9%</td>
                <td>0.0%</td>
                <td>129å„„å††</td>
                <td>Specialty Business Services</td>
                <td>61ç‚¹</td>
                <td class="text-success">ğŸŸ¡ æ¨å¥¨</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
            </tr>
            
            <tr>
                <td>15</td>
                <td>6436</td>
                <td>ã‚¢ãƒãƒ</td>
                <td>4041å††</td>
                <td>4.45%</td>
                <td>70.0%</td>
                <td>180å††</td>
                <td>1.4</td>
                <td>250å††</td>
                <td>16.2å€</td>
                <td>2.1å€</td>
                <td>1.6å€</td>
                <td>13.5%</td>
                <td>0.0%</td>
                <td>286å„„å††</td>
                <td>Scientific & Technical Instruments</td>
                <td>53ç‚¹</td>
                <td class="text-warning">ğŸŸ  è¦æ¤œè¨</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
            </tr>
            
            <tr>
                <td>16</td>
                <td>9757</td>
                <td>èˆ¹äº•ç·ç ”ï¼¨ï¼¬ï¼¤ï¼§</td>
                <td>2497å††</td>
                <td>3.40%</td>
                <td>80.0%</td>
                <td>86å††</td>
                <td>1.5</td>
                <td>128å††</td>
                <td>19.5å€</td>
                <td>4.6å€</td>
                <td>3.5å€</td>
                <td>24.3%</td>
                <td>0.0%</td>
                <td>114å„„å††</td>
                <td>Consulting Services</td>
                <td>53ç‚¹</td>
                <td class="text-warning">ğŸŸ  è¦æ¤œè¨</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
                <td class="portfolio-column" style="display: none;">-</td>
            </tr>
            
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="controls">
            <div class="control-header" onclick="toggleFilters()">
                <h3>ğŸ” ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼</h3>
                <span id="filterIcon">â–¼</span>
            </div>
            <div class="control-content" id="filterContent">
                <div style="margin-bottom: 15px;">
                    
        <button class="btn-filter" onclick="filterTable('all')">å…¨ã¦</button>
        <button class="btn-filter" onclick="filterTable('strong')">å¼·åŠ›æ¨å¥¨</button>
        <button class="btn-filter" onclick="filterTable('recommended')">æ¨å¥¨</button>
        <button class="btn-filter" onclick="filterTable('consider')">è¦æ¤œè¨</button>
        <button class="btn-filter" onclick="filterTable('not_recommended')">éæ¨å¥¨</button>
        
                </div>
            </div>
        </div>
        
        <div class="controls">
            <div class="control-header" onclick="toggleColumnFilter()">
                <h3>ğŸ‘ï¸ è¡¨ç¤ºé …ç›®ã®é¸æŠ</h3>
                <span id="columnFilterIcon">â–¼</span>
            </div>
            <div class="control-content" id="columnFilterContent">
                <div class="column-filter">
                    
            <label>
                <input type="checkbox" checked onchange="toggleColumn(0, this)">
                é †ä½
            </label>
            
            <label>
                <input type="checkbox" checked onchange="toggleColumn(1, this)">
                éŠ˜æŸ„ã‚³ãƒ¼ãƒ‰
            </label>
            
            <label>
                <input type="checkbox" checked onchange="toggleColumn(2, this)">
                éŠ˜æŸ„å
            </label>
            
            <label>
                <input type="checkbox" checked onchange="toggleColumn(3, this)">
                ç¾åœ¨å€¤
            </label>
            
            <label>
                <input type="checkbox" checked onchange="toggleColumn(4, this)">
                é…å½“åˆ©å›ã‚Š
            </label>
            
            <label>
                <input type="checkbox" checked onchange="toggleColumn(5, this)">
                é…å½“æ€§å‘
            </label>
            
            <label>
                <input type="checkbox" checked onchange="toggleColumn(6, this)">
                1æ ªé…å½“
            </label>
            
            <label>
                <input type="checkbox" checked onchange="toggleColumn(7, this)">
                é…å½“ã‚«ãƒãƒ¬ãƒƒã‚¸
            </label>
            
            <label>
                <input type="checkbox" checked onchange="toggleColumn(8, this)">
                EPS
            </label>
            
            <label>
                <input type="checkbox" checked onchange="toggleColumn(9, this)">
                PER
            </label>
            
            <label>
                <input type="checkbox" checked onchange="toggleColumn(10, this)">
                PBR
            </label>
            
            <label>
                <input type="checkbox" checked onchange="toggleColumn(11, this)">
                PSR
            </label>
            
            <label>
                <input type="checkbox" checked onchange="toggleColumn(12, this)">
                ROE
            </label>
            
            <label>
                <input type="checkbox" checked onchange="toggleColumn(13, this)">
                å–¶æ¥­åˆ©ç›Šç‡
            </label>
            
            <label>
                <input type="checkbox" checked onchange="toggleColumn(14, this)">
                æ™‚ä¾¡ç·é¡
            </label>
            
            <label>
                <input type="checkbox" checked onchange="toggleColumn(15, this)">
                æ¥­ç•Œ
            </label>
            
            <label>
                <input type="checkbox" checked onchange="toggleColumn(16, this)">
                æŠ•è³‡ã‚¹ã‚³ã‚¢
            </label>
            
            <label>
                <input type="checkbox" checked onchange="toggleColumn(17, this)">
                æŠ•è³‡æ¨å¥¨
            </label>
            
                </div>
            </div>
        </div>
        
        <div class="explanation-section">
            <div class="explanation-header" onclick="toggleExplanation()">
                <h3>ğŸ“š é …ç›®è§£èª¬</h3>
                <span id="explanationIcon">â–¼</span>
            </div>
            <div class="explanation-content" id="explanationContent">
                
        <div class="explanation-card">
            <h6>ğŸ’° é…å½“é–¢é€£æŒ‡æ¨™</h6>
            <p><strong>é…å½“åˆ©å›ã‚Š:</strong> å¹´é–“é…å½“é‡‘ Ã· ç¾åœ¨æ ªä¾¡ Ã— 100ã€‚æŠ•è³‡é¡ã«å¯¾ã™ã‚‹å¹´é–“é…å½“åå…¥ã®å‰²åˆã€‚</p>
            <p><strong>é…å½“æ€§å‘:</strong> å¹´é–“é…å½“é‡‘ Ã· 1æ ªå½“ãŸã‚Šç´”åˆ©ç›Š Ã— 100ã€‚åˆ©ç›Šã®ä½•å‰²ã‚’é…å½“ã«å›ã—ã¦ã„ã‚‹ã‹ã€‚</p>
            <p><strong>1æ ªé…å½“:</strong> 1æ ªå½“ãŸã‚Šã®å¹´é–“é…å½“é‡‘é¡ã€‚</p>
            <p><strong>é…å½“ã‚«ãƒãƒ¬ãƒƒã‚¸:</strong> ç´”åˆ©ç›Š Ã· é…å½“ç·é¡ã€‚é…å½“ã®æŒç¶šå¯èƒ½æ€§ã‚’ç¤ºã™ï¼ˆ2.0ä»¥ä¸ŠãŒç†æƒ³ï¼‰ã€‚</p>
        </div>
        
        <div class="explanation-card">
            <h6>ğŸ“Š åç›Šæ€§æŒ‡æ¨™</h6>
            <p><strong>EPS (1æ ªå½“ãŸã‚Šç´”åˆ©ç›Š):</strong> ç´”åˆ©ç›Š Ã· ç™ºè¡Œæ¸ˆã¿æ ªå¼æ•°ã€‚1æ ªå½“ãŸã‚Šã®åˆ©ç›Šã€‚</p>
            <p><strong>ROE (è‡ªå·±è³‡æœ¬åˆ©ç›Šç‡):</strong> ç´”åˆ©ç›Š Ã· è‡ªå·±è³‡æœ¬ Ã— 100ã€‚è‡ªå·±è³‡æœ¬ã®åŠ¹ç‡æ€§ï¼ˆ15%ä»¥ä¸ŠãŒç†æƒ³ï¼‰ã€‚</p>
            <p><strong>å–¶æ¥­åˆ©ç›Šç‡:</strong> å–¶æ¥­åˆ©ç›Š Ã· å£²ä¸Šé«˜ Ã— 100ã€‚æœ¬æ¥­ã®åç›Šæ€§ã€‚</p>
        </div>
        
        <div class="explanation-card">
            <h6>ğŸ’ ãƒãƒªãƒ¥ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³æŒ‡æ¨™</h6>
            <p><strong>PER (æ ªä¾¡åç›Šç‡):</strong> ç¾åœ¨æ ªä¾¡ Ã· 1æ ªå½“ãŸã‚Šç´”åˆ©ç›Šã€‚åˆ©ç›Šã«å¯¾ã™ã‚‹æ ªä¾¡ã®å‰²å®‰æ„Ÿï¼ˆ15å€ä»¥ä¸‹ãŒç†æƒ³ï¼‰ã€‚</p>
            <p><strong>PBR (æ ªä¾¡ç´”è³‡ç”£å€ç‡):</strong> ç¾åœ¨æ ªä¾¡ Ã· 1æ ªå½“ãŸã‚Šç´”è³‡ç”£ã€‚è³‡ç”£ã«å¯¾ã™ã‚‹æ ªä¾¡ã®å‰²å®‰æ„Ÿï¼ˆ1.5å€ä»¥ä¸‹ãŒç†æƒ³ï¼‰ã€‚</p>
            <p><strong>PSR (æ ªä¾¡å£²ä¸Šé«˜å€ç‡):</strong> æ™‚ä¾¡ç·é¡ Ã· å£²ä¸Šé«˜ã€‚å£²ä¸Šã«å¯¾ã™ã‚‹æ ªä¾¡ã®å‰²å®‰æ„Ÿã€‚</p>
        </div>
        
        <div class="explanation-card">
            <h6>ğŸ¯ æŠ•è³‡è©•ä¾¡æŒ‡æ¨™</h6>
            <p><strong>æŠ•è³‡ã‚¹ã‚³ã‚¢:</strong> é…å½“åˆ©å›ã‚Šã€è²¡å‹™å¥å…¨æ€§ã€æˆé•·æ€§ã‚’ç·åˆè©•ä¾¡ã—ãŸç‚¹æ•°ï¼ˆ100ç‚¹æº€ç‚¹ï¼‰ã€‚</p>
            <p><strong>æŠ•è³‡é©æ€§:</strong> æŠ•è³‡ã‚¹ã‚³ã‚¢ã«åŸºã¥ãç·åˆè©•ä¾¡ï¼ˆå¼·åŠ›æ¨å¥¨ãƒ»æ¨å¥¨ãƒ»è¦æ¤œè¨ãƒ»éæ¨å¥¨ï¼‰ã€‚</p>
            <p><strong>æŠ•è³‡æ¨å¥¨ãƒ¬ãƒ™ãƒ«:</strong> æŠ•è³‡é©æ€§ã®è©³ç´°ãƒ¬ãƒ™ãƒ«ã€‚æŠ•è³‡åˆ¤æ–­ã®å‚è€ƒæŒ‡æ¨™ã€‚</p>
        </div>
        
            </div>
        </div>
    </div>
    
    <script>
        // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ©Ÿèƒ½
        function toggleFilters() {
            const content = document.getElementById('filterContent');
            const icon = document.getElementById('filterIcon');
            if (content.style.display === 'none' || content.style.display === '') {
                content.style.display = 'block';
                icon.textContent = 'â–²';
            } else {
                content.style.display = 'none';
                icon.textContent = 'â–¼';
            }
        }
        
        function toggleColumnFilter() {
            const content = document.getElementById('columnFilterContent');
            const icon = document.getElementById('columnFilterIcon');
            if (content.style.display === 'none' || content.style.display === '') {
                content.style.display = 'block';
                icon.textContent = 'â–²';
            } else {
                content.style.display = 'none';
                icon.textContent = 'â–¼';
            }
        }
        
        function toggleExplanation() {
            const content = document.getElementById('explanationContent');
            const icon = document.getElementById('explanationIcon');
            if (content.style.display === 'none' || content.style.display === '') {
                content.style.display = 'block';
                icon.textContent = 'â–²';
            } else {
                content.style.display = 'none';
                icon.textContent = 'â–¼';
            }
        }
        
        function togglePortfolio() {
            const content = document.getElementById('portfolioContent');
            const icon = document.getElementById('portfolioIcon');
            if (content.style.display === 'none' || content.style.display === '') {
                content.style.display = 'block';
                icon.textContent = 'â–²';
            } else {
                content.style.display = 'none';
                icon.textContent = 'â–¼';
            }
        }
        
        // åˆ—è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
        function toggleColumn(columnIndex, checkbox) {
            const table = document.getElementById('mainTable');
            const rows = table.getElementsByTagName('tr');
            
            for (let i = 0; i < rows.length; i++) {
                const cell = rows[i].cells[columnIndex];
                if (cell) {
                    cell.style.display = checkbox.checked ? '' : 'none';
                }
            }
        }
        
        // åˆ†æ•£æŠ•è³‡è¨ˆç®—æ©Ÿèƒ½
        function calculatePortfolio() {
            // ãƒœã‚¿ãƒ³é€£æ‰“é˜²æ­¢
            const calculateBtn = document.getElementById('calculateBtn');
            if (calculateBtn.disabled) {
                return;
            }
            calculateBtn.disabled = true;
            calculateBtn.textContent = 'è¨ˆç®—ä¸­...';
            
            // è¨ˆç®—å‡¦ç†ã‚’éåŒæœŸã§å®Ÿè¡Œ
            setTimeout(() => {
                try {
                    const totalAmount = parseInt(document.getElementById('totalAmount').value);
                    const numStocks = parseInt(document.getElementById('numStocks').value);
                    const minScore = parseInt(document.getElementById('minScore').value);
                    const strategy = document.getElementById('strategy').value;
            
                    if (!totalAmount || !numStocks) {
                        alert('æŠ•è³‡é‡‘é¡ã¨éŠ˜æŸ„æ•°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                        return;
                    }
            
                    // ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ˜ãƒƒãƒ€ãƒ¼ã‹ã‚‰åˆ—ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’å‹•çš„ã«å–å¾—
                    const table = document.getElementById('mainTable');
                    const headerRow = table.getElementsByTagName('tr')[0];
                    const headers = Array.from(headerRow.cells).map(cell => cell.textContent.trim());
            
            // åˆ—ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’å–å¾—
            const getColumnIndex = (columnName) => {
                const index = headers.indexOf(columnName);
                if (index === -1) {
                    console.warn(`åˆ—ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: ${columnName}`);
                    return -1;
                }
                return index;
            };
            
            const priceIndex = getColumnIndex('ç¾åœ¨å€¤');
            const dividendYieldIndex = getColumnIndex('é…å½“åˆ©å›ã‚Š');
            const dividendPerShareIndex = getColumnIndex('1æ ªé…å½“');
            const scoreIndex = getColumnIndex('æŠ•è³‡ã‚¹ã‚³ã‚¢');
            
            if (priceIndex === -1 || dividendYieldIndex === -1 || dividendPerShareIndex === -1 || scoreIndex === -1) {
                alert('å¿…è¦ãªåˆ—ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚');
                return;
            }
            
            const rows = Array.from(table.getElementsByTagName('tr')).slice(1); // ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’é™¤å¤–
            
            let eligibleStocks = [];
            rows.forEach((row, index) => {
                const scoreCell = row.cells[scoreIndex];
                if (scoreCell) {
                    const scoreText = scoreCell.textContent.replace('ç‚¹', ''); // "80ç‚¹" -> "80"
                    const score = parseFloat(scoreText);
                    if (!isNaN(score) && score >= minScore) {
                        const price = parseFloat(row.cells[priceIndex].textContent.replace(/[^0-9.-]/g, ''));
                        const dividendYield = parseFloat(row.cells[dividendYieldIndex].textContent.replace('%', ''));
                        const dividendPerShare = parseFloat(row.cells[dividendPerShareIndex].textContent.replace(/[^0-9.-]/g, ''));
                        
                        if (!isNaN(price) && !isNaN(dividendYield) && !isNaN(dividendPerShare)) {
                            eligibleStocks.push({
                                index: index,
                                score: score,
                                price: price,
                                dividendYield: dividendYield,
                                dividendPerShare: dividendPerShare,
                                row: row
                            });
                        }
                    }
                }
            });
            
            if (eligibleStocks.length === 0) {
                alert('æ¡ä»¶ã‚’æº€ãŸã™éŠ˜æŸ„ãŒã‚ã‚Šã¾ã›ã‚“');
                return;
            }
            
            // ã‚¹ã‚³ã‚¢é †ã§ã‚½ãƒ¼ãƒˆ
            eligibleStocks.sort((a, b) => b.score - a.score);
            
            // ä¸Šä½éŠ˜æŸ„ã‚’é¸æŠ
            const selectedStocks = eligibleStocks.slice(0, Math.min(numStocks, eligibleStocks.length));
            
            // é…åˆ†è¨ˆç®—
            let weights = [];
            if (strategy === 'equal') {
                weights = new Array(selectedStocks.length).fill(1 / selectedStocks.length);
            } else if (strategy === 'score_weighted') {
                const totalScore = selectedStocks.reduce((sum, stock) => sum + stock.score, 0);
                weights = selectedStocks.map(stock => stock.score / totalScore);
            } else if (strategy === 'dividend_weighted') {
                const totalDividendYield = selectedStocks.reduce((sum, stock) => sum + stock.dividendYield, 0);
                weights = selectedStocks.map(stock => stock.dividendYield / totalDividendYield);
            }
            
            // å„éŠ˜æŸ„ã®æŠ•è³‡é‡‘é¡ã¨è³¼å…¥æ ªæ•°ã‚’è¨ˆç®—ï¼ˆ1æ ªå˜ä½ã§è³¼å…¥å¯èƒ½ï¼‰
            let totalInvested = 0;
            let totalDividend = 0;
            
            // ã‚¹ãƒ†ãƒƒãƒ—1ï¼šåŸºæœ¬çš„ãªç­‰é…åˆ†ã§åˆæœŸè¨ˆç®—
            const targetAmountPerStock = totalAmount / selectedStocks.length;
            
            selectedStocks.forEach((stock, index) => {
                let investmentAmount;
                
                if (strategy === 'equal') {
                    investmentAmount = targetAmountPerStock;
                } else if (strategy === 'score_weighted') {
                    investmentAmount = totalAmount * weights[index];
                } else if (strategy === 'dividend_weighted') {
                    investmentAmount = totalAmount * weights[index];
                } else {
                    investmentAmount = targetAmountPerStock;
                }
                
                // 1æ ªå˜ä½ã§è³¼å…¥æ ªæ•°ã‚’è¨ˆç®—
                const shares = Math.floor(investmentAmount / stock.price);
                const actualAmount = shares * stock.price;
                const annualDividend = shares * stock.dividendPerShare;
                
                // ä¸€æ™‚çš„ã«çµæœã‚’ä¿å­˜
                stock.shares = shares;
                stock.actualAmount = actualAmount;
                stock.annualDividend = annualDividend;
                
                totalInvested += actualAmount;
                totalDividend += annualDividend;
            });
            
            // ã‚¹ãƒ†ãƒƒãƒ—2ï¼šä½™å‰°é‡‘ã‚’å†é…åˆ†
            let remainingAmount = totalAmount - totalInvested;
            
            // æ ªä¾¡ã®å®‰ã„é †ã«ã‚½ãƒ¼ãƒˆã—ã¦ã€ä½™å‰°é‡‘ã§è¿½åŠ è³¼å…¥
            const sortedStocks = [...selectedStocks].sort((a, b) => a.price - b.price);
            
            sortedStocks.forEach(stock => {
                while (remainingAmount >= stock.price) {
                    stock.shares += 1;
                    stock.actualAmount += stock.price;
                    stock.annualDividend += stock.dividendPerShare;
                    remainingAmount -= stock.price;
                }
            });
            
            // æœ€çµ‚çš„ãªåˆè¨ˆã‚’å†è¨ˆç®—
            totalInvested = selectedStocks.reduce((sum, stock) => sum + stock.actualAmount, 0);
            totalDividend = selectedStocks.reduce((sum, stock) => sum + stock.annualDividend, 0);
            
            // è¡¨ã«çµæœã‚’è¡¨ç¤º
            selectedStocks.forEach((stock) => {
                // ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªåˆ—ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’å–å¾—ï¼ˆãƒ†ãƒ¼ãƒ–ãƒ«ã®æœ€å¾Œã®3åˆ—ï¼‰
                const totalColumns = stock.row.cells.length;
                const sharesCellIndex = totalColumns - 3; // è³¼å…¥æ ªæ•°
                const amountCellIndex = totalColumns - 2; // æŠ•è³‡é‡‘é¡
                const dividendCellIndex = totalColumns - 1; // å¹´é–“é…å½“åå…¥
                
                const sharesCell = stock.row.cells[sharesCellIndex];
                const amountCell = stock.row.cells[amountCellIndex];
                const dividendCell = stock.row.cells[dividendCellIndex];
                
                if (sharesCell) sharesCell.textContent = stock.shares.toLocaleString() + 'æ ª';
                if (amountCell) amountCell.textContent = stock.actualAmount.toLocaleString() + 'å††';
                if (dividendCell) dividendCell.textContent = stock.annualDividend.toLocaleString() + 'å††';
            });
            
            // ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªåˆ—ã‚’è¡¨ç¤º
            const portfolioColumns = document.querySelectorAll('.portfolio-column');
            portfolioColumns.forEach(col => col.style.display = '');
            
        // æ¥­ç•Œåã®ç¿»è¨³ãƒãƒƒãƒ”ãƒ³ã‚°
        const industryTranslation = {
            'Industrial Distribution': 'ç”£æ¥­æµé€š',
            'Auto Parts': 'è‡ªå‹•è»Šéƒ¨å“',
            'Auto & Truck Dealerships': 'è‡ªå‹•è»Šè²©å£²',
            'Scientific & Technical Instruments': 'ç§‘å­¦æŠ€è¡“æ©Ÿå™¨',
            'Engineering & Construction': 'å»ºè¨­ãƒ»åœŸæœ¨',
            'Building Products & Equipment': 'å»ºæãƒ»è¨­å‚™',
            'Utilities - Regulated Electric': 'é›»åŠ›ãƒ»ã‚¬ã‚¹',
            'Staffing & Employment Services': 'äººææ´¾é£',
            'Specialty Business Services': 'å°‚é–€ã‚µãƒ¼ãƒ“ã‚¹',
            'Information Technology Services': 'ITã‚µãƒ¼ãƒ“ã‚¹',
            'Chemicals': 'åŒ–å­¦',
            'Telecom Services': 'é€šä¿¡ã‚µãƒ¼ãƒ“ã‚¹',
            'Consulting Services': 'ã‚³ãƒ³ã‚µãƒ«ãƒ†ã‚£ãƒ³ã‚°'
        };
        
        // æ¥­ç•Œåã‚’æ—¥æœ¬èªã«ç¿»è¨³ã™ã‚‹é–¢æ•°
        function translateIndustry(englishName) {
            return industryTranslation[englishName] || englishName;
        }
        
        // æ¥­ç•Œåˆ†å¸ƒã‚’è¨ˆç®—
        const industryStats = {};
        selectedStocks.forEach((stock, index) => {
            // æ¥­ç•Œåˆ—ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’å‹•çš„ã«å–å¾—
            const industryIndex = headers.indexOf('æ¥­ç•Œ');
            const industryCell = industryIndex !== -1 ? stock.row.cells[industryIndex] : null;
            
            if (industryCell) {
                const industry = translateIndustry(industryCell.textContent);
                if (!industryStats[industry]) {
                    industryStats[industry] = {
                        count: 0,
                        totalAmount: 0,
                        totalDividend: 0
                    };
                }
                
                // å®Ÿéš›ã®æŠ•è³‡é‡‘é¡ã¨é…å½“ã‚’å–å¾—ï¼ˆãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªåˆ—ã‹ã‚‰ï¼‰
                const totalColumns = stock.row.cells.length;
                const amountCellIndex = totalColumns - 2; // æŠ•è³‡é‡‘é¡
                const dividendCellIndex = totalColumns - 1; // å¹´é–“é…å½“åå…¥
                
                const actualAmount = parseFloat(stock.row.cells[amountCellIndex].textContent.replace(/[^0-9.-]/g, '')) || 0;
                const annualDividend = parseFloat(stock.row.cells[dividendCellIndex].textContent.replace(/[^0-9.-]/g, '')) || 0;
                    
                    if (actualAmount > 0) {
                        industryStats[industry].count++;
                        industryStats[industry].totalAmount += actualAmount;
                        industryStats[industry].totalDividend += annualDividend;
                    }
                }
            });
            
            // æ¥­ç•Œåˆ†æ•£åº¦ã‚’è¨ˆç®—ï¼ˆãƒãƒ¼ãƒ•ã‚£ãƒ³ãƒ€ãƒ¼ãƒ«æŒ‡æ•°ï¼‰
            const totalIndustries = Object.keys(industryStats).length;
            let hhi = 0;
            let diversificationScore = 0;
            
            // totalInvestedãŒ0ã®å ´åˆã®å‡¦ç†
            if (totalInvested > 0 && totalIndustries > 0) {
                Object.values(industryStats).forEach(stats => {
                    const share = stats.totalAmount / totalInvested;
                    hhi += share * share;
                });
                diversificationScore = (1 - hhi) * 100;
            }
            
            // æ¥­ç•Œåˆ†å¸ƒHTMLã‚’ç”Ÿæˆ
            let industryHTML = `
                <h4>ğŸ¢ æ¥­ç•Œåˆ†æ•£çŠ¶æ³</h4>
                <div style="background: rgba(255, 255, 255, 0.8); padding: 10px; border-radius: 4px; margin-bottom: 15px;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <strong>åˆ†æ•£åº¦ã‚¹ã‚³ã‚¢: ${diversificationScore.toFixed(1)}ç‚¹</strong>
                            <div style="font-size: 0.9rem; color: #64748b;">
                                æ¥­ç•Œæ•°: ${totalIndustries}æ¥­ç•Œ | ãƒãƒ¼ãƒ•ã‚£ãƒ³ãƒ€ãƒ¼ãƒ«æŒ‡æ•°: ${hhi.toFixed(3)}
                            </div>
                        </div>
                        <div style="color: ${diversificationScore > 70 ? '#059669' : diversificationScore > 50 ? '#d97706' : '#dc2626'}; font-weight: 600;">
                            ${diversificationScore > 70 ? 'è‰¯å¥½' : diversificationScore > 50 ? 'æ™®é€š' : 'é›†ä¸­'}
                        </div>
                    </div>
                </div>
            `;
            
            const sortedIndustries = Object.entries(industryStats)
                .sort((a, b) => b[1].totalAmount - a[1].totalAmount);
            
            sortedIndustries.forEach(([industry, stats]) => {
                const percentage = totalInvested > 0 ? (stats.totalAmount / totalInvested * 100).toFixed(1) : '0.0';
                industryHTML += `
                    <div class="industry-item">
                        <div>
                            <div class="industry-name">${industry}</div>
                            <div class="industry-stats">
                                ${stats.count}éŠ˜æŸ„ | ${stats.totalAmount.toLocaleString()}å†† | ${stats.totalDividend.toLocaleString()}å††/å¹´
                            </div>
                            <div class="industry-bar">
                                <div class="industry-bar-fill" style="width: ${percentage}%"></div>
                            </div>
                        </div>
                        <div style="color: #3b82f6; font-weight: 600; font-size: 1.1rem;">
                            ${percentage}%
                        </div>
                    </div>
                `;
            });
            
            // ã‚µãƒãƒªãƒ¼è¡¨ç¤º
            const summary = document.getElementById('portfolioSummary');
            summary.innerHTML = `
                <h4>ğŸ“Š ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªé…åˆ†çµæœ</h4>
                <p>æŠ•è³‡ç·é¡: ` + totalAmount.toLocaleString() + `å††</p>
                <p>å®Ÿéš›æŠ•è³‡é¡: ` + totalInvested.toLocaleString() + `å††</p>
                <p>æœªæŠ•è³‡é¡: ` + (totalAmount - totalInvested).toLocaleString() + `å††</p>
                <p>å¹´é–“é…å½“åå…¥: ` + totalDividend.toLocaleString() + `å††</p>
                <p>ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªåˆ©å›ã‚Š: ` + (totalInvested > 0 ? (totalDividend / totalInvested * 100).toFixed(2) : '0.00') + `%</p>
            `;
            summary.classList.add('active');
            
            // æ¥­ç•Œåˆ†å¸ƒè¡¨ç¤º
            const industryDistribution = document.getElementById('industryDistribution');
            if (industryDistribution) {
                industryDistribution.innerHTML = industryHTML;
                industryDistribution.classList.add('active');
            } else {
                // æ¥­ç•Œåˆ†å¸ƒè¦ç´ ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ä½œæˆ
                const industryDiv = document.createElement('div');
                industryDiv.id = 'industryDistribution';
                industryDiv.className = 'industry-distribution';
                industryDiv.innerHTML = industryHTML;
                industryDiv.classList.add('active');
                summary.parentNode.insertBefore(industryDiv, summary.nextSibling);
                }
                
                // è³¼å…¥æ ªæ•°ãƒ»æŠ•è³‡é‡‘é¡ã¨éŠ˜æŸ„åãƒ»ã‚³ãƒ¼ãƒ‰ã®è¡¨ã‚’ç”Ÿæˆ
                let stockTableHTML = `
                    <h4>ğŸ“‹ è³¼å…¥éŠ˜æŸ„ä¸€è¦§</h4>
                    <div style="background: rgba(255, 255, 255, 0.8); padding: 10px; border-radius: 4px; margin-bottom: 15px;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
                            <thead>
                                <tr style="background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%); color: white;">
                                    <th style="padding: 8px; text-align: left; border: 1px solid #ddd;">éŠ˜æŸ„ã‚³ãƒ¼ãƒ‰</th>
                                    <th style="padding: 8px; text-align: left; border: 1px solid #ddd;">éŠ˜æŸ„åï¼ˆã‚»ã‚¯ã‚¿ãƒ¼ï¼‰</th>
                                    <th style="padding: 8px; text-align: right; border: 1px solid #ddd;">è³¼å…¥æ ªæ•°</th>
                                    <th style="padding: 8px; text-align: right; border: 1px solid #ddd;">æŠ•è³‡é‡‘é¡</th>
                                    <th style="padding: 8px; text-align: right; border: 1px solid #ddd;">å¹´é–“é…å½“</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                selectedStocks.forEach((stock, index) => {
                    const totalColumns = stock.row.cells.length;
                    const sharesCellIndex = totalColumns - 3; // è³¼å…¥æ ªæ•°
                    const amountCellIndex = totalColumns - 2; // æŠ•è³‡é‡‘é¡
                    const dividendCellIndex = totalColumns - 1; // å¹´é–“é…å½“åå…¥
                    
                    const shares = stock.row.cells[sharesCellIndex].textContent;
                    const amount = stock.row.cells[amountCellIndex].textContent;
                    const dividend = stock.row.cells[dividendCellIndex].textContent;
                    
                    // éŠ˜æŸ„ã‚³ãƒ¼ãƒ‰ã€éŠ˜æŸ„åã€æ¥­ç•Œã‚’å–å¾—
                    const codeIndex = headers.indexOf('éŠ˜æŸ„ã‚³ãƒ¼ãƒ‰');
                    const nameIndex = headers.indexOf('éŠ˜æŸ„å');
                    const industryIndex = headers.indexOf('æ¥­ç•Œ');
                    
                    const stockCode = codeIndex !== -1 ? stock.row.cells[codeIndex].textContent : '';
                    const stockName = nameIndex !== -1 ? stock.row.cells[nameIndex].textContent : '';
                    const industry = industryIndex !== -1 ? translateIndustry(stock.row.cells[industryIndex].textContent) : '';
                    
                    stockTableHTML += `
                        <tr style="background: ` + (index % 2 === 0 ? 'rgba(248, 250, 252, 0.8)' : 'rgba(255, 255, 255, 0.9)') + `;">
                            <td style="padding: 8px; border: 1px solid #ddd; font-weight: 600; color: #3b82f6;">` + stockCode + `</td>
                            <td style="padding: 8px; border: 1px solid #ddd;">
                                <div style="font-weight: 500;">` + stockName + `</div>
                                <div style="font-size: 0.8rem; color: #64748b; margin-top: 2px;">` + industry + `</div>
                            </td>
                            <td style="padding: 8px; border: 1px solid #ddd; text-align: right;">` + shares + `</td>
                            <td style="padding: 8px; border: 1px solid #ddd; text-align: right;">` + amount + `</td>
                            <td style="padding: 8px; border: 1px solid #ddd; text-align: right;">` + dividend + `</td>
                        </tr>
                    `;
                });
                
                stockTableHTML += `
                            </tbody>
                        </table>
                    </div>
                `;
                
                // éŠ˜æŸ„è¡¨è¡¨ç¤º
                const stockTableDiv = document.getElementById('stockTable');
                if (stockTableDiv) {
                    stockTableDiv.innerHTML = stockTableHTML;
                    stockTableDiv.classList.add('active');
                } else {
                    // éŠ˜æŸ„è¡¨è¦ç´ ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ä½œæˆ
                    const stockDiv = document.createElement('div');
                    stockDiv.id = 'stockTable';
                    stockDiv.className = 'industry-distribution';
                    stockDiv.innerHTML = stockTableHTML;
                    stockDiv.classList.add('active');
                    summary.parentNode.insertBefore(stockDiv, summary.nextSibling);
                }
                } catch (error) {
                    console.error('è¨ˆç®—ã‚¨ãƒ©ãƒ¼:', error);
                    alert('è¨ˆç®—ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚');
                } finally {
                    // ãƒœã‚¿ãƒ³ã‚’å†æœ‰åŠ¹åŒ–
                    calculateBtn.disabled = false;
                    calculateBtn.textContent = 'ğŸ“Š åˆ†æ•£æŠ•è³‡ã‚’è¨ˆç®—';
                }
            }, 100); // 100mså¾Œã«å®Ÿè¡Œ
        }
        
        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã¨åˆ—é¸æŠã‚’é–‰ã˜ã‚‹
            document.getElementById('filterContent').style.display = 'none';
            document.getElementById('columnFilterContent').style.display = 'none';
            document.getElementById('explanationContent').style.display = 'none';
        });
    </script>
</body>
</html>
        